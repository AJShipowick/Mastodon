"use strict";var newPromoApp=new Vue({el:"#newPromoApp",data:{PromoModel:[],PromoImages:[],UserImages:[],currentImageID:"",imageType:"",FilesToUpload:[],fileError:""},mounted:function(){this.getPromoData();this.getUserImages()},methods:{getPromoData:function(){axios.get("/Promotion/CreatePromo/GetPromoData").then(function(n){newPromoApp.PromoModel=n.data;$("#promoData").show();$("#ajaxLoading").hide();newPromoApp.PromoModel.id?($("#osoContactForm").css({"background-color":newPromoApp.PromoModel.backgroundColor}),$("#osoButton").css({"background-color":newPromoApp.PromoModel.buttonColor}),newPromoApp.PromoModel.showCouponBorder&&$("#osoContactForm").css({border:"4px dashed #ccc"}),newPromoApp.imageType=newPromoApp.PromoModel.imageType):newPromoApp.imageType="coupon";$("#osoImage").attr("src",newPromoApp.getDefaultImagePath(newPromoApp.PromoModel.imageName));newPromoApp.setUserPromoProperties();showCustomPromoImage();closePromotion()}).catch(function(){})},setUserPromoProperties:function(){newPromoApp.PromoModel.sideOfScreen==="left"?($("#osoContactForm").css({float:"left"}),$("#osoImage").css({right:""}),$("#osoContainer").css({right:""})):($("#osoContactForm").css({float:"right"}),$("#osoImage").css({left:""}),$("#osoContainer").css({left:""}));closePromotion()},saveCustomPromo:function(){this.validForm()&&this.savePromo()},savePromo:function(){axios.post("/Promotion/CreatePromo/SaveNewPromo",newPromoApp.PromoModel).then(function(){window.location.href="/Dashboard"}).catch(function(){})},getPromoImages:function(n){newPromoApp.PromoImages=[];$("#imagesLoading").show();axios.get("/Promotion/CreatePromo/GetPromoImages?imageType="+n).then(function(t){newPromoApp.imageType=n;newPromoApp.PromoImages=t.data;$("#imagesLoading").hide()}).catch(function(){})},getUserImages:function(){axios.get("/Promotion/CreatePromo/GetUserImages").then(function(n){newPromoApp.UserImages=n.data}).catch(function(){})},getDefaultImagePath:function(n){return window.location.origin+"/images/Promo/"+newPromoApp.imageType+"/"+n},getUserImagePath:function(n){return window.location.origin+"/images/Promo/Users/"+n},setPromoImage:function(n,t,i){newPromoApp.currentImageID===""?newPromoApp.currentImageID=t:($("#"+newPromoApp.currentImageID).removeClass("promo-border"),newPromoApp.currentImageID=t);$("#"+t).addClass("promo-border");newPromoApp.PromoModel.imageName=n;i?(newPromoApp.PromoModel.imageType="Users",$("#osoImage").attr("src",newPromoApp.getUserImagePath(n))):(newPromoApp.PromoModel.imageType=newPromoApp.imageType,$("#osoImage").attr("src",newPromoApp.getDefaultImagePath(n)))},showCouponBorder:function(){newPromoApp.PromoModel.showCouponBorder=!newPromoApp.PromoModel.showCouponBorder;newPromoApp.PromoModel.showCouponBorder===!0?$("#osoContactForm").css({border:"4px dashed #ccc"}):$("#osoContactForm").css({border:"1px solid #d8d8d8"})},setFormBackgroundColor:function(){let n=$("#backgroundColor").val();$("#osoContactForm").css({"background-color":n})},setFormButtonColor:function(){let n=$("#buttonColor").val();$("#osoButton").css({"background-color":n})},submitSlider:function(){$("#submitSliderClick").modal("show")},validForm:function(){newPromoApp.hideErrors();let n=!0;return newPromoApp.PromoModel.title||($("#titleMissing").show(),n=!1),newPromoApp.PromoModel.endDate||($("#dateMissing").show(),n=!1),newPromoApp.PromoModel.code||($("#codeMissing").show(),n=!1),newPromoApp.PromoModel.discount||($("#discountMissing").show(),n=!1),newPromoApp.PromoModel.thankYouMessage||($("#thankYouMissing").show(),n=!1),n},hideErrors:function(){$("#titleMissing").hide();$("#dateMissing").hide();$("#codeMissing").hide();$("#discountMissing").hide();$("#thankYouMissing").hide()},fileChange:function(n){newPromoApp.FilesToUpload=[];newPromoApp.fileError="";let t=["image/gif","image/jpeg","image/png","image/svg+xml"];for(let i=0;i<n.length;i++)newPromoApp.FilesToUpload.push(n[i].name),n[i].size>1e6&&(newPromoApp.fileError="File size too big, max size 1MB"),$.inArray(n[i].type,t)<0&&(newPromoApp.fileError="Image must be (.gif, .jpeg, .png or .svg).")},formatDate:function(){let n=newPromoApp.PromoModel.endDate.split("-");newPromoApp.PromoModel.displayEndDate=n[1]+"/"+n[2]+"/"+n[0]},showHelpStep1:function(){$("#promoHelpModalStep1").modal("show")},showHelpStep2:function(){$("#promoHelpModalStep2").modal("show");$("#promoHelpModalStep1").modal("hide")},closeHelpStep2:function(){$("#promoHelpModalStep2").modal("hide")},showFormSubmitHelp:function(){$("#formSubmitHelpModal").modal("show")}}});